import{r as o,e as I,c as d,a as t,t as k,d as l,w as B,v as D,n as g,F as M,f as N,o as v}from"./index-CZfd177T.js";import{a as i}from"./axios-BimPEqV4.js";const O={id:"todoListPage",class:"bg-half"},P={class:"todo_sm"},E={href:"#/todoListPage"},F={class:"conatiner todoListPage vhContainer"},S={class:"todoList_Content"},V={class:"inputBox"},G={class:"todoList_list"},U={class:"todoList_tab"},j={class:"todoList_items"},q={class:"todoList_label"},H=["checked","onClick"],J=["onClick"],K={key:0,class:"todoList_statistics"},Q={key:1,class:"todoList_statistics"},c="https://todolist-api.hexschool.io",Z={__name:"TodoListPage",setup(R){const n=document.cookie.replace(/(?:(?:^|.*;\s*)customTodoToken\s*\=\s*([^;]*).*$)|^.*$/,"$1"),r=o([{}]),u=o([{}]),h=o(""),p=o(""),_=o(""),f=o(""),L=o(""),m=o(0);I(async()=>{try{const e=await i.get(`${c}/users/checkout`,{headers:{Authorization:n}});e.data.status==!0&&(L.value=e.data.nickname),w()}catch{window.alert("驗證錯誤，請重新登入"),window.location.assign("#/")}});const w=async()=>{try{const e=await i.get(`${c}/todos/`,{headers:{Authorization:n}});u.value=e.data.data,m.value=0,u.value.forEach(function(s){s.status==!1&&(m.value=m.value+1)}),y()}catch(e){window.alert(e.response.data.message)}},y=()=>{r.value=u.value,h.value="active",p.value="",_.value=""},$=()=>{r.value=u.value.filter(function(e){return e.status==!1}),h.value="",p.value="active",_.value=""},C=()=>{r.value=u.value.filter(function(e){return e.status==!0}),h.value="",p.value="",_.value="active"},T=async e=>{try{const s=await i.delete(`${c}/todos/${e}`,{headers:{Authorization:n}});w()}catch(s){window.alert(s.response.data.message)}},x=async()=>{try{const e=await i.post(`${c}/todos/`,{content:f.value},{headers:{Authorization:n}});f.value="",w()}catch(e){window.alert(e.response.data.message)}},z=async e=>{try{const s=await i.patch(`${c}/todos/${e}/toggle`,{id:e},{headers:{Authorization:n}});w()}catch(s){window.alert(s.response.data.message)}},b=async()=>{try{const e=await i.post(`${c}/users/sign_out`,{},{headers:{Authorization:n}});document.cookie=`customTodoToken=${e.data.token}; expires=Fri, 31 Dec 1970 23:59:59 GMT; path=/`,window.alert("登出成功，將跳轉回登入畫面"),window.location.assign("#/")}catch(e){window.alert(e.response.data.message)}};return(e,s)=>(v(),d("div",O,[t("nav",null,[s[1]||(s[1]=t("h1",null,[t("a",{href:"#/"},"ONLINE TODO LIST")],-1)),t("ul",null,[t("li",P,[t("a",E,[t("span",null,k(L.value)+"的代辦",1)])]),t("li",null,[t("a",{href:"/#/",onClick:l(b,["prevent"])},"登出")])])]),t("div",F,[t("div",S,[t("div",V,[B(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":s[0]||(s[0]=a=>f.value=a)},null,512),[[D,f.value]]),t("a",{href:"#/",onClick:l(x,["prevent"])},s[2]||(s[2]=[t("i",{class:"fa fa-plus"},null,-1)]))]),t("div",G,[t("ul",U,[t("li",null,[t("a",{href:"#/",class:g(h.value),onClick:l(y,["prevent"])},"全部",2)]),t("li",null,[t("a",{href:"#/",class:g(p.value),onClick:l($,["prevent"])},"待完成",2)]),t("li",null,[t("a",{href:"#/",class:g(_.value),onClick:l(C,["prevent"])},"已完成",2)])]),t("div",j,[(v(!0),d(M,null,N(r.value,(a,W)=>(v(),d("ul",{class:"todoList_item",key:a.id},[t("li",null,[t("label",q,[t("input",{class:"todoList_input",type:"checkbox",value:"true",checked:a.status,onClick:A=>z(a.id)},null,8,H),t("span",null,k(a.content),1)]),t("a",{href:"#/",onClick:l(A=>T(a.id),["prevent"])},s[3]||(s[3]=[t("i",{class:"fa fa-times"},null,-1)]),8,J)])]))),128)),r.value.length!=0?(v(),d("div",K,[t("p",null,k(m.value)+" 個待完成項目",1)])):(v(),d("div",Q,s[4]||(s[4]=[t("p",null,"目前尚無待辦事項",-1)])))])])])])]))}};export{Z as default};
